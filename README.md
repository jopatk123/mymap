# åœ°å›¾å…¨æ™¯ç³»ç»Ÿ

åŸºäº Vue 3 + Leaflet + Pannellum çš„åœ°å›¾å…¨æ™¯æŸ¥çœ‹ç³»ç»Ÿï¼Œæ”¯æŒé«˜å¾·åœ°å›¾ç“¦ç‰‡ã€åæ ‡ç³»è½¬æ¢å’Œå…¨æ™¯å›¾ç®¡ç†åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ—ºï¸ **åœ°å›¾æ˜¾ç¤º**: åŸºäº Leaflet çš„äº¤äº’å¼åœ°å›¾ï¼Œæ”¯æŒé«˜å¾·åœ°å›¾ç“¦ç‰‡
- ğŸ”„ **åæ ‡è½¬æ¢**: æ”¯æŒ WGS84ã€GCJ02ã€BD09 åæ ‡ç³»ä¹‹é—´çš„ç²¾ç¡®è½¬æ¢
- ğŸ“¸ **å…¨æ™¯å›¾ç®¡ç†**: å…¨æ™¯å›¾çš„å¢åˆ æ”¹æŸ¥ã€æ‰¹é‡ä¸Šä¼ ã€æœç´¢åŠŸèƒ½
- ğŸŒ **å…¨æ™¯æŸ¥çœ‹**: åŸºäº Pannellum çš„ 360Â° å…¨æ™¯å›¾æŸ¥çœ‹å™¨
- ğŸ“± **å“åº”å¼è®¾è®¡**: æ”¯æŒæ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯è®¿é—®
- ğŸš€ **é«˜æ€§èƒ½**: ä¼˜åŒ–çš„å›¾ç‰‡åŠ è½½å’Œç¼“å­˜ç­–ç•¥

## æŠ€æœ¯æ ˆ

### å‰ç«¯
- **Vue 3** - æ¸è¿›å¼ JavaScript æ¡†æ¶
- **Vite** - å¿«é€Ÿçš„å‰ç«¯æ„å»ºå·¥å…·
- **Leaflet** - å¼€æºåœ°å›¾åº“
- **Pannellum** - WebGL å…¨æ™¯å›¾æŸ¥çœ‹å™¨
- **Element Plus** - Vue 3 UI ç»„ä»¶åº“
- **Pinia** - Vue çŠ¶æ€ç®¡ç†
- **Axios** - HTTP å®¢æˆ·ç«¯

### åç«¯
- **Node.js** - JavaScript è¿è¡Œæ—¶
- **Express** - Web åº”ç”¨æ¡†æ¶
- **MySQL** - å…³ç³»å‹æ•°æ®åº“
- **Multer** - æ–‡ä»¶ä¸Šä¼ ä¸­é—´ä»¶
- **Sharp** - å›¾åƒå¤„ç†åº“
- **Joi** - æ•°æ®éªŒè¯åº“

## é¡¹ç›®ç»“æ„

```
panorama-map-project/
â”œâ”€â”€ client/                   # å‰ç«¯ Vue é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/       # ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ views/           # é¡µé¢
â”‚   â”‚   â”œâ”€â”€ composables/     # ç»„åˆå¼ API
â”‚   â”‚   â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ store/           # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ api/             # æ¥å£è¯·æ±‚
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ server/                   # åç«¯ Express é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ controllers/     # æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ services/        # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ models/          # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ routes/          # è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ middleware/      # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ config/          # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ scripts/                  # éƒ¨ç½²è„šæœ¬
â””â”€â”€ docs/                     # é¡¹ç›®æ–‡æ¡£
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 16.0.0
- MySQL >= 5.7
- npm >= 8.0.0

### å®‰è£…éƒ¨ç½²

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone <repository-url>
   cd panorama-map-project
   ```

2. **ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰**
   ```bash
   # å¼€å‘ç¯å¢ƒ
   ./scripts/deploy.sh --dev
   
   # ç”Ÿäº§ç¯å¢ƒ
   ./scripts/deploy.sh --prod
   ```

3. **æ‰‹åŠ¨éƒ¨ç½²**
   ```bash
   # å®‰è£…ä¾èµ–
   npm run install:all
   
   # é…ç½®æ•°æ®åº“
   mysql -u root -p < scripts/init-db.sql
   
   # é…ç½®ç¯å¢ƒå˜é‡
   cp server/.env.example server/.env
   # ç¼–è¾‘ server/.env æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ç­‰ä¿¡æ¯
   
   # å¯åŠ¨å¼€å‘æœåŠ¡
   npm run dev
   ```

### ç¯å¢ƒé…ç½®

ç¼–è¾‘ `server/.env` æ–‡ä»¶ï¼š

```env
# æœåŠ¡å™¨é…ç½®
PORT=3001
NODE_ENV=development

# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=panorama_map

# æ–‡ä»¶ä¸Šä¼ é…ç½®
UPLOAD_DIR=uploads
MAX_FILE_SIZE=10485760

# å®‰å…¨é…ç½®
CORS_ORIGIN=http://localhost:3000
```

## ä½¿ç”¨è¯´æ˜

### åŸºæœ¬æ“ä½œ

1. **æŸ¥çœ‹åœ°å›¾**: è®¿é—® http://localhost:3000 æŸ¥çœ‹åœ°å›¾ç•Œé¢
2. **æ·»åŠ å…¨æ™¯å›¾**: ç‚¹å‡»"æ·»åŠ "æŒ‰é’®ä¸Šä¼ å…¨æ™¯å›¾æ–‡ä»¶
3. **æŸ¥çœ‹å…¨æ™¯å›¾**: ç‚¹å‡»åœ°å›¾ä¸Šçš„æ ‡è®°ç‚¹æŸ¥çœ‹å…¨æ™¯å›¾
4. **æœç´¢åŠŸèƒ½**: ä½¿ç”¨ä¾§è¾¹æ æœç´¢æ¡†æŸ¥æ‰¾å…¨æ™¯å›¾

### API æ¥å£

ä¸»è¦ API ç«¯ç‚¹ï¼š

- `GET /api/panoramas` - è·å–å…¨æ™¯å›¾åˆ—è¡¨
- `POST /api/panoramas` - åˆ›å»ºå…¨æ™¯å›¾
- `GET /api/panoramas/:id` - è·å–å…¨æ™¯å›¾è¯¦æƒ…
- `PUT /api/panoramas/:id` - æ›´æ–°å…¨æ™¯å›¾
- `DELETE /api/panoramas/:id` - åˆ é™¤å…¨æ™¯å›¾
- `POST /api/panoramas/upload` - ä¸Šä¼ å…¨æ™¯å›¾æ–‡ä»¶
- `GET /api/panoramas/bounds` - æ ¹æ®åœ°å›¾è¾¹ç•Œè·å–å…¨æ™¯å›¾
- `GET /api/panoramas/nearby` - è·å–é™„è¿‘çš„å…¨æ™¯å›¾

è¯¦ç»† API æ–‡æ¡£è¯·è®¿é—®ï¼šhttp://localhost:3001/api

### åæ ‡ç³»è¯´æ˜

ç³»ç»Ÿæ”¯æŒä¸‰ç§åæ ‡ç³»ï¼š

- **WGS84**: GPS åæ ‡ç³»ï¼Œå›½é™…æ ‡å‡†
- **GCJ02**: é«˜å¾·åæ ‡ç³»ï¼Œä¸­å›½æ ‡å‡†
- **BD09**: ç™¾åº¦åæ ‡ç³»

ç³»ç»Ÿä¼šè‡ªåŠ¨è¿›è¡Œåæ ‡è½¬æ¢ï¼Œç¡®ä¿åœ°å›¾æ˜¾ç¤ºçš„å‡†ç¡®æ€§ã€‚

## å¼€å‘æŒ‡å—

### å‰ç«¯å¼€å‘

```bash
cd client
npm run dev    # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run build  # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```

### åç«¯å¼€å‘

```bash
cd server
npm run dev    # å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆnodemonï¼‰
npm start      # å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
```

### æ•°æ®åº“ç®¡ç†

```bash
# åˆå§‹åŒ–æ•°æ®åº“
mysql -u root -p < scripts/init-db.sql

# å¤‡ä»½æ•°æ®åº“
mysqldump -u root -p panorama_map > backup.sql

# æ¢å¤æ•°æ®åº“
mysql -u root -p panorama_map < backup.sql
```

## éƒ¨ç½²è¯´æ˜

### å¼€å‘ç¯å¢ƒ

```bash
./scripts/deploy.sh --dev
```

### ç”Ÿäº§ç¯å¢ƒ

```bash
./scripts/deploy.sh --prod
```

ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ PM2 è¿›è¡Œè¿›ç¨‹ç®¡ç†ï¼š

```bash
npm install -g pm2
pm2 start server/src/server.js --name panorama-map
pm2 startup
pm2 save
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥ MySQL æœåŠ¡æ˜¯å¦å¯åŠ¨
   - éªŒè¯ `.env` æ–‡ä»¶ä¸­çš„æ•°æ®åº“é…ç½®
   - ç¡®è®¤æ•°æ®åº“ç”¨æˆ·æƒé™

2. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**
   - æ£€æŸ¥ `uploads` ç›®å½•æƒé™
   - ç¡®è®¤æ–‡ä»¶å¤§å°ä¸è¶…è¿‡é™åˆ¶
   - éªŒè¯æ–‡ä»¶ç±»å‹æ˜¯å¦æ”¯æŒ

3. **åœ°å›¾ä¸æ˜¾ç¤º**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®è®¤é«˜å¾·åœ°å›¾ç“¦ç‰‡æœåŠ¡å¯è®¿é—®
   - éªŒè¯åæ ‡æ•°æ®æ ¼å¼

4. **å…¨æ™¯å›¾æ— æ³•æŸ¥çœ‹**
   - æ£€æŸ¥ Pannellum åº“æ˜¯å¦æ­£ç¡®åŠ è½½
   - ç¡®è®¤å…¨æ™¯å›¾æ–‡ä»¶è·¯å¾„æ­£ç¡®
   - éªŒè¯å›¾ç‰‡æ ¼å¼æ˜¯å¦æ”¯æŒ

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f server/logs/access.log
tail -f server/logs/error.log

# æŸ¥çœ‹ PM2 æ—¥å¿—
pm2 logs panorama-map
```

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- æäº¤ Issue
- å‘é€é‚®ä»¶è‡³ï¼š[your-email@example.com]

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-01-01)
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- åŸºç¡€åœ°å›¾åŠŸèƒ½
- å…¨æ™¯å›¾ç®¡ç†åŠŸèƒ½
- åæ ‡ç³»è½¬æ¢åŠŸèƒ½
- æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½