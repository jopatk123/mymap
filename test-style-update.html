<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‚¹ä½æ ·å¼æ›´æ–°æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        pre {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ¨ ç‚¹ä½æ ·å¼æ›´æ–°æµ‹è¯•</h1>
    
    <div class="test-section">
        <h3>æµ‹è¯•æ­¥éª¤</h3>
        <ol>
            <li>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·</li>
            <li>è®¿é—®åœ°å›¾é¡µé¢ï¼š<a href="http://localhost:3000" target="_blank">http://localhost:3000</a></li>
            <li>ç‚¹å‡»å³ä¸Šè§’çš„"ç‚¹ä½å›¾æ ‡"æŒ‰é’®</li>
            <li>ä¿®æ”¹è§†é¢‘ç‚¹ä½æˆ–å…¨æ™¯å›¾ç‚¹ä½çš„æ ·å¼</li>
            <li>ç‚¹å‡»"ä¿å­˜é…ç½®"</li>
            <li>è§‚å¯Ÿåœ°å›¾ä¸Šçš„ç‚¹ä½æ˜¯å¦ç«‹å³æ›´æ–°æ ·å¼</li>
        </ol>
    </div>

    <div class="test-section">
        <h3>é¢„æœŸç»“æœ</h3>
        <ul>
            <li>âœ… ç‚¹å‡»ä¿å­˜åï¼Œåœ°å›¾ä¸Šçš„ç‚¹ä½æ ·å¼åº”è¯¥ç«‹å³æ›´æ–°</li>
            <li>âœ… ä¸éœ€è¦æ‰‹åŠ¨åˆ·æ–°é¡µé¢</li>
            <li>âœ… æ§åˆ¶å°ä¸åº”è¯¥æœ‰é”™è¯¯ä¿¡æ¯</li>
            <li>âœ… æ ·å¼é…ç½®åº”è¯¥æ­£ç¡®ä¿å­˜åˆ°æœåŠ¡å™¨</li>
        </ul>
    </div>

    <div class="test-section">
        <h3>æµ‹è¯•API</h3>
        <button onclick="testVideoStyleAPI()">æµ‹è¯•è§†é¢‘ç‚¹ä½æ ·å¼API</button>
        <button onclick="testPanoramaStyleAPI()">æµ‹è¯•å…¨æ™¯å›¾ç‚¹ä½æ ·å¼API</button>
        <div id="api-result"></div>
    </div>

    <div class="test-section">
        <h3>æ•…éšœæ’é™¤</h3>
        <p>å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š</p>
        <ul>
            <li>åç«¯æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œï¼ˆhttp://localhost:3002ï¼‰</li>
            <li>å‰ç«¯å¼€å‘æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œï¼ˆhttp://localhost:3000ï¼‰</li>
            <li>æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰JavaScripté”™è¯¯</li>
            <li>ç½‘ç»œè¯·æ±‚æ˜¯å¦æˆåŠŸï¼ˆæ£€æŸ¥Networkæ ‡ç­¾ï¼‰</li>
        </ul>
    </div>

    <script>
        const API_BASE = 'http://localhost:3002/api';

        function displayResult(result, isError = false) {
            const element = document.getElementById('api-result');
            element.innerHTML = `<pre class="${isError ? 'error' : 'success'}">${JSON.stringify(result, null, 2)}</pre>`;
        }

        async function testVideoStyleAPI() {
            try {
                // æµ‹è¯•è·å–å½“å‰æ ·å¼
                const getResponse = await fetch(`${API_BASE}/point-styles/video`);
                const currentStyles = await getResponse.json();
                
                // æµ‹è¯•æ›´æ–°æ ·å¼
                const testStyles = {
                    point_color: '#ff0000',
                    point_size: 12,
                    point_opacity: 0.8,
                    point_label_size: 16,
                    point_label_color: '#ffffff'
                };
                
                const updateResponse = await fetch(`${API_BASE}/point-styles/video`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testStyles)
                });
                
                const updateResult = await updateResponse.json();
                
                displayResult({
                    message: 'è§†é¢‘ç‚¹ä½æ ·å¼APIæµ‹è¯•æˆåŠŸ',
                    currentStyles: currentStyles.data,
                    updatedStyles: updateResult.data
                });
                
            } catch (error) {
                displayResult({ error: error.message }, true);
            }
        }

        async function testPanoramaStyleAPI() {
            try {
                // æµ‹è¯•è·å–å½“å‰æ ·å¼
                const getResponse = await fetch(`${API_BASE}/point-styles/panorama`);
                const currentStyles = await getResponse.json();
                
                // æµ‹è¯•æ›´æ–°æ ·å¼
                const testStyles = {
                    point_color: '#00ff00',
                    point_size: 10,
                    point_opacity: 0.9,
                    point_label_size: 14,
                    point_label_color: '#000000'
                };
                
                const updateResponse = await fetch(`${API_BASE}/point-styles/panorama`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testStyles)
                });
                
                const updateResult = await updateResponse.json();
                
                displayResult({
                    message: 'å…¨æ™¯å›¾ç‚¹ä½æ ·å¼APIæµ‹è¯•æˆåŠŸ',
                    currentStyles: currentStyles.data,
                    updatedStyles: updateResult.data
                });
                
            } catch (error) {
                displayResult({ error: error.message }, true);
            }
        }
    </script>
</body>
</html>