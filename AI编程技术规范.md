# AI 编程协作通用规范

本规范旨在定义 AI 辅助编程时的通用协作标准、代码质量要求及工程化最佳实践，适用于大多数现代全栈开发项目。

## 1. AI 协作流程

1.  **任务准备**：
    *   AI 在接到需求后，应先阅读项目上下文（目录结构、配置文件、现有文档）。
    *   建立 Todo List，明确任务步骤。
    *   若需求不清或存在风险，需主动向用户确认。

2.  **执行原则**：
    *   **测试驱动**：优先考虑测试，遵循"先测试，再实现"或"实现后立即补充测试"的原则。
    *   **单一职责**：保持代码模块化，避免大文件（建议单文件 ≤ 400 行）。
    *   **非交互式执行**：运行命令（如测试、构建）时，确保使用非交互模式（如 `--run`, `--no-watch`）。

3.  **验证与交付**：
    *   执行 Lint 检查和相关测试，确保代码质量。
    *   Git 提交信息遵循 [Conventional Commits](https://www.conventionalcommits.org) 规范。
    *   同步更新文档（README, API 文档, 环境变量示例等）。

## 2. 代码质量与风格

*   **一致性**：遵循项目现有的 Lint (ESLint/Stylelint) 和格式化 (Prettier) 配置。若无配置，应推荐主流社区标准。
*   **命名规范**：
    *   变量/函数：`camelCase`
    *   类/组件/接口：`PascalCase`
    *   常量：`UPPER_SNAKE_CASE`
    *   文件名：遵循框架惯例（如 Vue 使用 `PascalCase.vue`，JS/TS 模块使用 `kebab-case` 或 `camelCase`）。
*   **注释与文档**：
    *   复杂逻辑需添加行内注释解释"为什么"。
    *   公共函数/组件应包含 JSDoc/TSDoc 注释。
    *   Hack 或临时方案必须标注 `TODO` 及原因。

## 3. 架构与目录规范

*   **模块化**：按功能或职责划分目录（如 `components`, `services`, `utils`, `models`）。
*   **分层架构**：
    *   **表现层**（UI/Controller）：负责交互与参数校验。
    *   **业务层**（Service/Logic）：处理核心业务逻辑。
    *   **数据层**（Repository/Store）：负责数据存取与状态管理。
    *   严禁跨层直接访问（如 UI 直接操作数据库）。
*   **文件拆分**：
    *   当文件过大或职责过多时，应拆分为子模块或子目录。
    *   相关联的文件（源码、测试、类型定义）建议就近放置。

## 4. 开发与工程化

*   **环境管理**：
    *   区分 `local`, `dev`, `prod` 等环境。
    *   敏感配置通过环境变量（`.env`）管理，禁止硬编码。
    *   提供 `.env.example` 作为配置模板。
*   **依赖管理**：
    *   定期检查依赖更新，避免引入废弃或有安全风险的包。
    *   锁文件（`package-lock.json` / `yarn.lock` / `pnpm-lock.yaml`）必须提交。
*   **脚本规范**：
    *   `package.json` 中应提供标准的 `dev`, `build`, `test`, `lint` 脚本。
    *   提供一键启动/停止脚本（如 `docker-compose` 或 shell 脚本）以简化开发环境搭建。

## 5. 接口与数据规范

*   **API 设计**：
    *   遵循 RESTful 或 GraphQL 标准。
    *   统一响应结构（如 `{ success, data, error }`）。
    *   统一错误码与错误处理机制。
*   **数据验证**：
    *   前后端均需进行数据验证（前端提升体验，后端保障安全）。
    *   使用 Schema 验证库（如 Zod, Joi, Yup）确保类型安全。

## 6. 测试规范

*   **覆盖范围**：核心业务逻辑和关键 UI 组件必须有测试覆盖。
*   **测试类型**：
    *   **单元测试**：针对工具函数、独立组件。
    *   **集成测试**：针对 API 接口、模块间交互。
*   **可维护性**：测试代码也应保持整洁，避免过度 Mock 导致测试脆弱。
